<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GymTrack Pro</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* --- 1. Root Variables & Global Styles --- */
        :root {
            --primary-green: #4CAF50;
            --primary-green-dark: #45a049;
            --light-gray: #f4f4f9;
            --medium-gray: #e0e0e0;
            --dark-gray: #555;
            --text-color: #333;
            --white: #ffffff;
            --danger: #e74c3c;
            --danger-dark: #c0392b;
            --border-radius-sm: 8px;
            --border-radius-md: 12px;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--light-gray);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            padding: 20px;
            min-height: 100vh;
        }

        /* --- 2. Main App Container --- */
        .app-container {
            width: 100%;
            max-width: 450px; /* Mobile-first design */
            min-height: 80vh;
            background-color: var(--white);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- 3. Screen Management --- */
        .screen {
            display: none; /* Hidden by default */
            flex-direction: column;
            flex-grow: 1;
            animation: fadeIn 0.3s ease-out;
        }

        .screen.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- 4. Headers --- */
        .screen-header {
            padding: 20px;
            border-bottom: 1px solid var(--medium-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .screen-header h1, .screen-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        /* Specific header for day screen */
        #day-screen-header h2 {
            font-size: 1.25rem; /* Smaller to fit buttons */
            text-align: center;
            flex-grow: 1;
        }

        /* --- 5. Content Body --- */
        .screen-body {
            padding: 20px;
            flex-grow: 1;
            overflow-y: auto;
        }

        /* --- 6. Footer & Buttons --- */
        .screen-footer {
            padding: 20px;
            border-top: 1px solid var(--medium-gray);
            background-color: var(--white);
        }

        .btn {
            font-family: 'Poppins', sans-serif;
            width: 100%;
            padding: 14px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .btn-primary {
            background-color: var(--primary-green);
            color: var(--white);
        }
        .btn-primary:hover {
            background-color: var(--primary-green-dark);
        }
        
        .btn-secondary {
            background-color: var(--medium-gray);
            color: var(--dark-gray);
        }
        .btn-secondary:hover {
            background-color: #ccc;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: var(--white);
        }
        .btn-danger:hover {
            background-color: var(--danger-dark);
        }

        .btn-icon {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 5px;
            color: var(--dark-gray);
        }
        .btn-icon:hover {
            color: var(--danger);
        }
        
        .btn-small {
            width: auto;
            padding: 8px 12px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .btn-back {
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            color: var(--primary-green);
            cursor: pointer;
            padding: 5px;
        }
        .btn-back:hover {
            text-decoration: underline;
        }


        /* --- 7. Home Screen Styles --- */
        #workout-day-list {
            display: grid;
            gap: 15px;
        }

        .day-card {
            background-color: var(--white);
            border: 1px solid var(--medium-gray);
            border-radius: var(--border-radius-sm);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            transition: all 0.2s ease;
        }
        .day-card-name {
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            flex-grow: 1;
        }
        .day-card-actions {
            display: flex;
            gap: 10px;
        }
        
        /* --- 8. Workout Day Screen Styles --- */
        #exercise-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .exercise-card {
            background-color: var(--white);
            border: 1px solid var(--medium-gray);
            border-radius: var(--border-radius-sm);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .exercise-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background-color: #fcfcfc;
            border-bottom: 1px solid var(--medium-gray);
        }

        .exercise-header h3 {
            font-size: 1.15rem;
            font-weight: 600;
        }
        
        .set-table-container {
            padding: 0 15px 15px 15px;
        }

        .set-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .set-table th, .set-table td {
            text-align: center;
            padding: 10px 5px;
            font-size: 0.9rem;
        }

        .set-table th {
            font-weight: 600;
            color: var(--dark-gray);
            border-bottom: 2px solid var(--medium-gray);
        }
        
        .set-table tr:not(:last-child) td {
            border-bottom: 1px solid var(--light-gray);
        }
        
        .set-table .col-set { width: 15%; }
        .set-table .col-reps, .set-table .col-weight { width: 35%; }
        .set-table .col-action { width: 15%; }

        .set-table input[type="number"] {
            width: 100%;
            max-width: 80px;
            padding: 8px;
            border: 1px solid var(--medium-gray);
            border-radius: var(--border-radius-sm);
            font-family: 'Poppins', sans-serif;
            font-size: 0.9rem;
            text-align: center;
            /* Hide arrows */
            -moz-appearance: textfield;
        }
        .set-table input::-webkit-outer-spin-button,
        .set-table input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        .add-set-btn-container {
            text-align: right;
            padding-top: 15px;
        }

        /* --- 9. Modal Styles --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--white);
            padding: 30px;
            border-radius: var(--border-radius-md);
            text-align: center;
            box-shadow: var(--shadow-lg);
            transform: scale(0.9);
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active .modal-content {
            transform: scale(1);
        }

        .modal-content h2 {
            font-size: 1.5rem;
            margin-bottom: 20px;
        }
        
    </style>
</head>
<body>

    <div class="app-container">

        <section id="home-screen" class="screen active">
            <header class="screen-header">
                <h1>Workout Days</h1>
            </header>
            <main class="screen-body">
                <div id="workout-day-list">
                    </div>
            </main>
            <footer class="screen-footer">
                <button id="add-day-btn" class="btn btn-primary">+ Add Workout Day</button>
            </footer>
        </section>

        <section id="day-screen" class="screen">
            <header class="screen-header" id="day-screen-header">
                <button id="back-to-home-btn" class="btn-back">&larr; Back</button>
                <h2 id="day-title">Workout Title 🟢</h2>
                <button id="finish-workout-btn" class="btn btn-primary btn-small">Finish</button>
            </header>
            <main class="screen-body" id="exercise-list-container">
                <div id="exercise-list">
                    </div>
            </main>
            <footer class="screen-footer">
                <button id="add-exercise-btn" class="btn btn-primary">+ Add Exercise</button>
            </footer>
        </section>

        <div id="finish-modal" class="modal-overlay">
            <div class="modal-content">
                <h2>Workout Completed 💪</h2>
                <button id="close-modal-btn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- 1. STATE & CONSTANTS ---
        let db;
        const DB_KEY = 'gymTrackerProDB';
        let currentDayId = null;

        // --- 2. DOM SELECTORS ---
        const screens = document.querySelectorAll('.screen');
        const homeScreen = document.getElementById('home-screen');
        const dayScreen = document.getElementById('day-screen');
        const finishModal = document.getElementById('finish-modal');
        
        // Home Screen
        const addDayBtn = document.getElementById('add-day-btn');
        const workoutDayList = document.getElementById('workout-day-list');
        
        // Day Screen
        const backToHomeBtn = document.getElementById('back-to-home-btn');
        const dayTitle = document.getElementById('day-title');
        const finishWorkoutBtn = document.getElementById('finish-workout-btn');
        const exerciseList = document.getElementById('exercise-list');
        const addExerciseBtn = document.getElementById('add-exercise-btn');
        
        // Modal
        const closeModalBtn = document.getElementById('close-modal-btn');

        // --- 3. DATABASE (localStorage) FUNCTIONS ---
        
        /**
         * Loads the database from localStorage or initializes a new one
         */
        function loadDB() {
            const data = localStorage.getItem(DB_KEY);
            db = data ? JSON.parse(data) : { workoutDays: [] };
        }

        /**
         * Saves the current database state to localStorage
         */
        function saveDB() {
            localStorage.setItem(DB_KEY, JSON.stringify(db));
        }

        /**
         * Generates a simple unique ID
         */
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substring(2);
        }

        // --- 4. NAVIGATION FUNCTION ---
        
        /**
         * Hides all screens and shows the one with the specified ID
         * @param {string} screenId - The ID of the screen to show
         */
        function showScreen(screenId) {
            screens.forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // --- 5. RENDER FUNCTIONS ---
        
        /**
         * Renders the list of workout days on the home screen
         */
        function renderHomeScreen() {
            workoutDayList.innerHTML = ''; // Clear existing list
            
            if (db.workoutDays.length === 0) {
                workoutDayList.innerHTML = '<p style="text-align: center; color: #888;">No workout days added yet. <br>Click "+ Add Workout Day" to start!</p>';
                return;
            }
            
            db.workoutDays.forEach(day => {
                const dayCard = document.createElement('div');
                dayCard.className = 'day-card';
                dayCard.dataset.dayId = day.id;
                
                dayCard.innerHTML = `
                    <span class="day-card-name">${day.name}</span>
                    <div class="day-card-actions">
                        <button class="btn-icon btn-rename-day" title="Rename" data-day-id="${day.id}">✏️</button>
                        <button class="btn-icon btn-delete-day" title="Delete" data-day-id="${day.id}">🗑️</button>
                    </div>
                `;
                workoutDayList.appendChild(dayCard);
            });
            
            showScreen('home-screen');
        }
        
        /**
         * Renders the details of a specific workout day
         * @param {string} dayId - The ID of the workout day to render
         */
        function renderDayScreen(dayId) {
            currentDayId = dayId;
            const day = db.workoutDays.find(d => d.id === dayId);
            
            if (!day) {
                console.error('Workout day not found');
                showScreen('home-screen');
                return;
            }
            
            dayTitle.textContent = `${day.name} 🟢`;
            exerciseList.innerHTML = ''; // Clear existing list
            
            day.exercises.forEach(exercise => {
                const exerciseCard = document.createElement('div');
                exerciseCard.className = 'exercise-card';
                exerciseCard.dataset.exerciseId = exercise.id;
                
                let setsHtml = '';
                exercise.sets.forEach((set, index) => {
                    setsHtml += `
                        <tr data-set-index="${index}">
                            <td class="col-set"><strong>${index + 1}</strong></td>
                            <td class="col-reps">
                                <input type="number" class="set-input set-reps" value="${set.reps}" min="0" placeholder="Reps">
                            </td>
                            <td class="col-weight">
                                <input type="number" class="set-input set-weight" value="${set.weight}" min="0" placeholder="Weight">
                            </td>
                            <td class="col-action">
                                <button class="btn-icon btn-delete-set" title="Delete Set" data-set-index="${index}">&times;</button>
                            </td>
                        </tr>
                    `;
                });
                
                exerciseCard.innerHTML = `
                    <div class="exercise-header">
                        <h3>${exercise.name}</h3>
                        <button class="btn-icon btn-delete-exercise" title="Delete Exercise" data-exercise-id="${exercise.id}">🗑️</button>
                    </div>
                    <div class="set-table-container">
                        <table class="set-table">
                            <thead>
                                <tr>
                                    <th class="col-set">Set</th>
                                    <th class="col-reps">Reps</th>
                                    <th class="col-weight">Weight (lbs)</th>
                                    <th class="col-action"></th>
                                </tr>
                            </thead>
                            <tbody>
                                ${setsHtml}
                            </tbody>
                        </table>
                        <div class="add-set-btn-container">
                            <button class="btn btn-secondary btn-small add-set-btn" data-exercise-id="${exercise.id}">+ Add Set</button>
                        </div>
                    </div>
                `;
                exerciseList.appendChild(exerciseCard);
            });
            
            showScreen('day-screen');
        }

        // --- 6. CORE LOGIC & EVENT HANDLERS ---

        // --- Home Screen Logic ---
        addDayBtn.addEventListener('click', () => {
            const name = prompt('Enter a name for the new workout day:');
            if (name && name.trim()) {
                const newDay = {
                    id: generateId(),
                    name: name.trim(),
                    exercises: []
                };
                db.workoutDays.push(newDay);
                saveDB();
                renderHomeScreen();
            }
        });

        workoutDayList.addEventListener('click', (e) => {
            const dayId = e.target.closest('.day-card')?.dataset.dayId;
            if (!dayId) return;

            if (e.target.classList.contains('btn-delete-day')) {
                // --- Delete Day ---
                if (confirm('Are you sure you want to delete this workout day?')) {
                    db.workoutDays = db.workoutDays.filter(day => day.id !== dayId);
                    saveDB();
                    renderHomeScreen();
                }
            } else if (e.target.classList.contains('btn-rename-day')) {
                // --- Rename Day ---
                const day = db.workoutDays.find(d => d.id === dayId);
                const newName = prompt('Enter new name:', day.name);
                if (newName && newName.trim()) {
                    day.name = newName.trim();
                    saveDB();
                    renderHomeScreen();
                }
            } else if (e.target.classList.contains('day-card-name')) {
                // --- Open Day ---
                renderDayScreen(dayId);
            }
        });

        // --- Day Screen Logic ---
        backToHomeBtn.addEventListener('click', () => {
            renderHomeScreen();
            currentDayId = null;
        });

        addExerciseBtn.addEventListener('click', () => {
            const name = prompt('Enter a name for the new exercise:');
            if (name && name.trim()) {
                const day = db.workoutDays.find(d => d.id === currentDayId);
                const newExercise = {
                    id: generateId(),
                    name: name.trim(),
                    sets: [
                        { reps: 0, weight: 0 } // Add one default set
                    ]
                };
                day.exercises.push(newExercise);
                saveDB();
                renderDayScreen(currentDayId);
            }
        });

        exerciseList.addEventListener('click', (e) => {
            const exerciseCard = e.target.closest('.exercise-card');
            if (!exerciseCard) return;
            
            const exerciseId = exerciseCard.dataset.exerciseId;
            const day = db.workoutDays.find(d => d.id === currentDayId);
            const exercise = day.exercises.find(ex => ex.id === exerciseId);

            if (e.target.classList.contains('add-set-btn')) {
                // --- Add Set ---
                const lastSet = exercise.sets[exercise.sets.length - 1] || { reps: 0, weight: 0 };
                // Add a new set, copying the last set's values
                exercise.sets.push({ ...lastSet });
                saveDB();
                renderDayScreen(currentDayId);
            }
            
            if (e.target.classList.contains('btn-delete-set')) {
                // --- Delete Set ---
                const setIndex = parseInt(e.target.dataset.setIndex, 10);
                exercise.sets.splice(setIndex, 1);
                saveDB();
                renderDayScreen(currentDayId);
            }
            
            if (e.target.classList.contains('btn-delete-exercise')) {
                // --- Delete Exercise ---
                if (confirm('Are you sure you want to delete this exercise?')) {
                    day.exercises = day.exercises.filter(ex => ex.id !== exerciseId);
                    saveDB();
                    renderDayScreen(currentDayId);
                }
            }
        });

        // Auto-save on set input change (using 'change' event)
        exerciseList.addEventListener('change', (e) => {
            if (!e.target.classList.contains('set-input')) return;
            
            const exerciseCard = e.target.closest('.exercise-card');
            const setRow = e.target.closest('tr');
            
            const dayId = currentDayId;
            const exerciseId = exerciseCard.dataset.exerciseId;
            const setIndex = parseInt(setRow.dataset.setIndex, 10);
            const value = parseFloat(e.target.value) || 0;
            
            const day = db.workoutDays.find(d => d.id === dayId);
            const exercise = day.exercises.find(ex => ex.id === exerciseId);
            
            if (e.target.classList.contains('set-reps')) {
                exercise.sets[setIndex].reps = value;
            } else if (e.target.classList.contains('set-weight')) {
                exercise.sets[setIndex].weight = value;
            }
            
            saveDB();
            // No re-render needed, just save
        });

        // --- Modal Logic ---
        finishWorkoutBtn.addEventListener('click', () => {
            finishModal.classList.add('active');
        });

        closeModalBtn.addEventListener('click', () => {
            finishModal.classList.remove('active');
        });

        finishModal.addEventListener('click', (e) => {
            // Close if clicking overlay
            if (e.target === finishModal) {
                finishModal.classList.remove('active');
            }
        });

        // --- 7. INITIALIZATION ---
        function init() {
            loadDB();
            renderHomeScreen();
        }

        init();
    });
    </script>

</body>
</html>
